@using PetitesPuces.Models
@using PetitesPuces.Utilities
@model PetitesPuces.Models.Panier

@{
    ViewBag.SousTotal = @Model.Articles.Sum(a => a.PPProduit.PrixVente * a.NbItems);
    ViewBag.FraisLivraison = (decimal)23.00;
}
<div class="row">
    <div class="col-md-8" style="height: 70vh;
                                       overflow: auto;">
        <table class="table table-hover">
            <tbody>
            @foreach(PPArticlesEnPanier article in @Model.Articles)
            {
                @Html.Partial("Client/_ProduitsPanier", article)
            }
            </tbody>
        </table>
    </div>
    <div class="col-md-4">
        <button class="btn btn-danger">Supprimer ce panier</button>
        <br/>
        <br/>
        <div class="panel panel-primary">
            <div class="panel-heading">RÃ©capitulaif (2 articles): </div>
            <div class="panel-body">
                <div class="h4">
                    <p class="row">
                        <div class="col-xs-6">Articles :</div>
                        <div class="col-xs-6">@Formatter.Money(ViewBag.SousTotal)</div></p>
                    <p class="row">
                        <div class="col-xs-6">Livraison :</div>
                        <div class="col-xs-6"> @Formatter.Money(ViewBag.FraisLivraison)</div></p>

                    <div class="row">
                        <br/><hr/>
                    </div>

                    <p class="row">
                        <div class="col-xs-6">Sous total:</div>
                        <div class="col-xs-6"> @Formatter.Money(ViewBag.SousTotal + ViewBag.FraisLivraison)</div></p>
                    <p class="row">
                        <div class="col-xs-6">TPS :</div>
                        <div class="col-xs-6"> @Formatter.Money((ViewBag.SousTotal + ViewBag.FraisLivraison) * (decimal)0.05)</div></p>
                    <p class="row">
                        <div class="col-xs-6">tvq :</div>
                        <div class="col-xs-6"> @Formatter.Money((ViewBag.SousTotal + ViewBag.FraisLivraison) * (decimal)0.09975)</div></p>

                    <div class="row">
                        <br/><hr/>
                    </div>

                    <p class="row">             
                        <div class="col-xs-6">Montant total:</div> 
                        <div class="col-xs-6">@Formatter.Money(ViewBag.SousTotal + ViewBag.FraisLivraison + (ViewBag.SousTotal + ViewBag.FraisLivraison) * (decimal)0.05 + (ViewBag.SousTotal + ViewBag.FraisLivraison) * (decimal)0.09975)</div> 
                    </p>
                    <br/>    
                </div>

                
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#confirmationCommande">
                    Passer la commande
                </button>
            </div>
        </div>
        <div class="panel panel-success">
            <div class="panel-heading">Informations sur le vendeur: </div>
            <div class="panel-body">
                <div class="h4">
                    <p><a href="@Url.Action("Catalogue", "Client", new RouteValueDictionary(new { Vendeur= @ViewBag.Vendeur }))">@Model.Vendeur.Nom</a></p>
                    <p>Membre depuis @Model.Vendeur.DateCreation.ToString()</p>
                    <p>Entreprise : @Model.Vendeur.NomAffaires</p>

                    <hr/>

                    <p>Nombres de ventes : @Model.Vendeur.PPCommandes.Count</p>
                </div>
            </div>
        </div>
    </div>
</div>